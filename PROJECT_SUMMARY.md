# ููุฎุต ูุดุฑูุน ูุธุงู ููุชุฑุฉ ุนุฏุงุฏุงุช ุงูููุฑุจุงุก โก

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ููุชุฑุฉ ุนุฏุงุฏุงุช ุงูููุฑุจุงุก ูุน ูุงุฌูุฉ ุจุฑูุฌูุฉ (API) ูุงููุฉ ุชุฏุนู ุงูุฑุจุท ูุน ุชุทุจููุงุช ุงูููุจ ูุงูุฃูุฏุฑููุฏ.

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ (PostgreSQL/MySQL)

ุชุญุชูู ุนูู **11 ุฌุฏูู**:

| ุงูุฌุฏูู | ุงููุตู | ุงูุญููู ุงูุฑุฆูุณูุฉ |
|--------|-------|-----------------|
| `users` | ุงููุณุชุฎุฏููู ูุงูููุธููู | id, openId, name, email, role |
| `customers` | ุงูุนููุงุก | id, fullName, phone, email, address, city, status |
| `employees` | ุงูููุธููู | id, fullName, position, department, phone, email |
| `meters` | ุงูุนุฏุงุฏุงุช | id, meterNumber, customerId, type, location, status |
| `readings` | ุงููุฑุงุกุงุช | id, meterId, readingDate, currentReading, consumption |
| `tariffs` | ุงูุชุนุฑููุงุช | id, name, pricePerUnit, minUnits, maxUnits |
| `invoices` | ุงูููุงุชูุฑ | id, customerId, amount, dueDate, status |
| `payments` | ุงููุฏููุนุงุช | id, invoiceId, amount, paymentDate, method |
| `notifications` | ุงูุฅุดุนุงุฑุงุช | id, userId, title, message, type, isRead |
| `complaints` | ุงูุดูุงูู | id, customerId, subject, description, status, priority |
| `activityLogs` | ุณุฌู ุงููุดุงุทุงุช | id, userId, action, entity, details |

### 2. ุงููุงุฌูุฉ ุงูุจุฑูุฌูุฉ (tRPC API)

**7 Routers** ูุงููุฉ:

#### ๐ Auth Router
- `auth.me` - ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
- `auth.logout` - ุชุณุฌูู ุงูุฎุฑูุฌ

#### ๐ฅ Customers Router
- `customers.getAll` - ุฌูุจ ุฌููุน ุงูุนููุงุก
- `customers.getById` - ุฌูุจ ุนููู ูุญุฏุฏ
- `customers.create` - ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ
- `customers.update` - ุชุญุฏูุซ ุจูุงูุงุช ุนููู
- `customers.delete` - ุญุฐู ุนููู
- `customers.search` - ุงูุจุญุซ ูู ุงูุนููุงุก

#### โก Meters Router
- `meters.getAll` - ุฌูุจ ุฌููุน ุงูุนุฏุงุฏุงุช
- `meters.getById` - ุฌูุจ ุนุฏุงุฏ ูุญุฏุฏ
- `meters.getByCustomerId` - ุฌูุจ ุนุฏุงุฏุงุช ุนููู
- `meters.create` - ุฅุถุงูุฉ ุนุฏุงุฏ ุฌุฏูุฏ
- `meters.update` - ุชุญุฏูุซ ุจูุงูุงุช ุนุฏุงุฏ
- `meters.delete` - ุญุฐู ุนุฏุงุฏ

#### ๐ Readings Router
- `readings.getAll` - ุฌูุจ ุฌููุน ุงููุฑุงุกุงุช
- `readings.getByMeterId` - ุฌูุจ ูุฑุงุกุงุช ุนุฏุงุฏ ูุญุฏุฏ
- `readings.create` - ุฅุถุงูุฉ ูุฑุงุกุฉ ุฌุฏูุฏุฉ
- `readings.update` - ุชุญุฏูุซ ูุฑุงุกุฉ
- `readings.delete` - ุญุฐู ูุฑุงุกุฉ

#### ๐ฐ Invoices Router
- `invoices.getAll` - ุฌูุจ ุฌููุน ุงูููุงุชูุฑ
- `invoices.getById` - ุฌูุจ ูุงุชูุฑุฉ ูุญุฏุฏุฉ
- `invoices.getByCustomerId` - ุฌูุจ ููุงุชูุฑ ุนููู
- `invoices.create` - ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ
- `invoices.update` - ุชุญุฏูุซ ูุงุชูุฑุฉ
- `invoices.delete` - ุญุฐู ูุงุชูุฑุฉ
- `invoices.markAsPaid` - ุชุญุฏูุฏ ูุงุชูุฑุฉ ููุฏููุนุฉ

#### ๐ณ Payments Router
- `payments.getAll` - ุฌูุจ ุฌููุน ุงููุฏููุนุงุช
- `payments.getByInvoiceId` - ุฌูุจ ูุฏููุนุงุช ูุงุชูุฑุฉ
- `payments.create` - ุชุณุฌูู ุฏูุนุฉ ุฌุฏูุฏุฉ

#### ๐ข Complaints Router
- `complaints.getAll` - ุฌูุจ ุฌููุน ุงูุดูุงูู
- `complaints.getById` - ุฌูุจ ุดููู ูุญุฏุฏุฉ
- `complaints.getByCustomerId` - ุฌูุจ ุดูุงูู ุนููู
- `complaints.create` - ุชูุฏูู ุดููู ุฌุฏูุฏุฉ
- `complaints.update` - ุชุญุฏูุซ ุดููู
- `complaints.updateStatus` - ุชุญุฏูุซ ุญุงูุฉ ุดููู

### 3. ูุงุฌูุฉ ุงููุณุชุฎุฏู (React + TypeScript)

#### ุงูุตูุญุงุช ุงูููุชููุฉ:
- โ **ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (Dashboard)**
  - ุฅุญุตุงุฆูุงุช ุดุงููุฉ (6 ุจุทุงูุงุช)
  - ุฌุฏุงูู ุขุฎุฑ ุงูููุงุชูุฑ ูุงูุดูุงูู
  - ุฃุฒุฑุงุฑ ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ

- โ **ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุนููุงุก**
  - ุฌุฏูู ุจุฌููุน ุงูุนููุงุก
  - ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู
  - ุงูุจุญุซ ูุงูุชุตููุฉ

#### ุงูุตูุญุงุช ุงููุทููุจุฉ:
- โณ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุนุฏุงุฏุงุช
- โณ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุฑุงุกุงุช
- โณ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ
- โณ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุฏููุนุงุช
- โณ ุตูุญุฉ ุงูุดูุงูู
- โณ ุตูุญุฉ ุงูุชูุงุฑูุฑ

### 4. ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ

ุชู ุฅุฏุฑุงุฌ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูุงููุฉ:
- โ 5 ุนููุงุก
- โ 5 ุนุฏุงุฏุงุช
- โ 5 ูุฑุงุกุงุช
- โ 5 ููุงุชูุฑ
- โ 2 ูุฏููุนุงุช

### 5. ุงูุชูุซูู

- โ `README.md` - ุฏููู ุงููุดุฑูุน ุงููุงูู
- โ `DOCUMENTATION.md` - ุงูุชูุซูู ุงูููู ุงูุชูุตููู
- โ `todo.md` - ูุงุฆูุฉ ุงูููุงู

---

## ๐ ุงูุชุญุฏูุซุงุช ุงูููุชุฑุญุฉ (ุจูุงุกู ุนูู ุงููุดุฑูุน ุงูุนุงููู)

ุชู ุชุญููู ูุดุฑูุน **EB-Billing-System** ุงูุนุงููู ูุงุณุชุฎุฑุงุฌ ุฃูุถู ุงูููุงุฑุณุงุช:

### ุงูุชุญุณููุงุช ุงูุฑุฆูุณูุฉ:

#### 1. **ูุตู ุงูุงุชุตุงูุงุช ุงูููุฒููุฉ ูุงูุชุฌุงุฑูุฉ**
```sql
-- ุจุฏูุงู ูู ุฌุฏูู ุนููุงุก ูุงุญุฏุ ูุณุชุฎุฏู:
household_connections  -- ููุงุชุตุงูุงุช ุงูููุฒููุฉ
commercial_connections -- ููุงุชุตุงูุงุช ุงูุชุฌุงุฑูุฉ
```

**ุงูููุงุฆุฏ:**
- ุชุฎุตูุต ุญููู ููู ููุน (ูุซู: business_name ููุชุฌุงุฑู)
- ุญุณุงุจ ูุฎุชูู ููููุงุชูุฑ ุญุณุจ ุงูููุน
- ูุฑููุฉ ุฃูุจุฑ ูู ุงูุฅุฏุงุฑุฉ

#### 2. **ุญุณุงุจ ุชููุงุฆู ููููุงุชูุฑ ุจุงูุดุฑุงุฆุญ**

**ููุงุชุตุงูุงุช ุงูููุฒููุฉ:**
- 0-50 ูุญุฏุฉ: ูุฌุงูู
- 51-100 ูุญุฏุฉ: 2 ุฑูุงู/ูุญุฏุฉ
- 101-300 ูุญุฏุฉ: 4 ุฑูุงู/ูุญุฏุฉ
- 300+ ูุญุฏุฉ: 6 ุฑูุงู/ูุญุฏุฉ

**ููุงุชุตุงูุงุช ุงูุชุฌุงุฑูุฉ:**
- 0-20 ูุญุฏุฉ: ูุฌุงูู
- 21-100 ูุญุฏุฉ: 4 ุฑูุงู/ูุญุฏุฉ
- 101-200 ูุญุฏุฉ: 6 ุฑูุงู/ูุญุฏุฉ
- 200+ ูุญุฏุฉ: 8 ุฑูุงู/ูุญุฏุฉ

#### 3. **Triggers ุชููุงุฆูุฉ**
```sql
-- ุนูุฏ ุฅุฏุฑุงุฌ ูุฑุงุกุฉ ุฌุฏูุฏุฉ:
1. ุญุณุงุจ ุงููุจูุบ ุญุณุจ ุงูุดุฑุงุฆุญ
2. ุฅูุดุงุก ูุงุชูุฑุฉ ุชููุงุฆููุง
3. ุชุญุฏูุฏ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู (30 ููู)
```

#### 4. **ุญููู ุฅุถุงููุฉ ูููุฉ**
- `applicant_photo` - ุตูุฑุฉ ููุฏู ุงูุทูุจ
- `property_tax_report` - ุชูุฑูุฑ ุงูุถุฑูุจุฉ ุงูุนูุงุฑูุฉ
- `ownership_proof` - ุฅุซุจุงุช ุงูููููุฉ (ููุชุฌุงุฑู)
- `phase` - ููุน ุงูุทูุฑ (ุฃุญุงุฏู/ุซูุงุซู)
- `load_required` - ุงูุญูู ุงููุทููุจ
- `sq_meter` - ุงููุณุงุญุฉ ุจุงููุชุฑ ุงููุฑุจุน (ููุชุฌุงุฑู)

---

## ๐ ุงููููุงุช ุงูุฌุงูุฒุฉ ููุชุทุจูู

### 1. Schema ุงูุฌุฏูุฏ
**ุงููููุน:** `/home/ubuntu/electricity-billing-api/drizzle/schema_new.ts`

ูุญุชูู ุนูู:
- 9 ุฌุฏุงูู ูุญุฏุซุฉ
- Types ูุงููุฉ ูู TypeScript
- ุนูุงูุงุช Foreign Keys

### 2. SQL Script ุงููุงูู
**ุงููููุน:** `/home/ubuntu/electricity-billing-api/create_new_db.sql`

ูุญุชูู ุนูู:
- ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู
- Triggers ููุญุณุงุจ ุงูุชููุงุฆู
- Indexes ููุฃุฏุงุก
- Foreign Keys ููุนูุงูุงุช

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู ุงูููุชุฑุญุฉ

### ุงููุฑุญูุฉ 1: ุชุทุจูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
```bash
# 1. ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ
mysql -u root -p < create_new_db.sql

# 2. ุชุญุฏูุซ ููู .env
DATABASE_URL=mysql://user:pass@localhost:3306/electricity_billing_v2

# 3. ุชุทุจูู Schema ุงูุฌุฏูุฏ
cp drizzle/schema_new.ts drizzle/schema.ts
pnpm db:push
```

### ุงููุฑุญูุฉ 2: ุชุญุฏูุซ ุงูููุฏ
1. ุชุญุฏูุซ `server/db.ts` - ุฏูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุชุญุฏูุซ `server/routers.ts` - ููุงุท API
3. ุชุญุฏูุซ `client/src/pages/` - ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงููุฑุญูุฉ 3: ุงูุงุฎุชุจุงุฑ
1. ุงุฎุชุจุงุฑ APIs
2. ุงุฎุชุจุงุฑ Triggers
3. ุงุฎุชุจุงุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงููุฑุญูุฉ 4: ุงููุดุฑ
1. ุญูุธ Checkpoint
2. ูุดุฑ ุนูู ุงูุฅูุชุงุฌ

---

## ๐ ููุงุฑูุฉ ุงููุธุงููู

| ุงูููุฒุฉ | ุงููุธุงู ุงูุญุงูู | ุงููุธุงู ุงููุญุฏุซ |
|--------|--------------|---------------|
| **ุงูุฌุฏุงูู** | 11 ุฌุฏูู | 9 ุฌุฏุงูู (ูุญุณููุฉ) |
| **ุฃููุงุน ุงูุงุชุตุงูุงุช** | ุฌุฏูู ูุงุญุฏ ููุนููุงุก | ุฌุฏุงูู ูููุตูุฉ (ููุฒูู/ุชุฌุงุฑู) |
| **ุญุณุงุจ ุงูููุงุชูุฑ** | ูุฏูู | ุชููุงุฆู ุจุงูุดุฑุงุฆุญ |
| **Triggers** | ูุง ููุฌุฏ | 2 triggers ููุญุณุงุจ |
| **ุงููุณุชูุฏุงุช** | ูุง ููุฌุฏ | ุฏุนู ุฑูุน ุงูุตูุฑ ูุงููุณุชูุฏุงุช |
| **ุงูุชุนุฑููุงุช** | ุฌุฏูู ูููุตู | ูุฏูุฌุฉ ูู Triggers |

---

## ๐ฏ ุงูุชูุตูุงุช

### ููุงุณุชุฎุฏุงู ุงูููุฑู:
โ **ุงููุธุงู ุงูุญุงูู ุฌุงูุฒ ุชูุงููุง** ููููู ุงุณุชุฎุฏุงูู ูุจุงุดุฑุฉ
- ูุงุนุฏุฉ ุจูุงูุงุช ูุงููุฉ
- APIs ุดุงููุฉ
- ูุงุฌูุฉ ูุณุชุฎุฏู ุฃุณุงุณูุฉ
- ุจูุงูุงุช ุชุฌุฑูุจูุฉ

### ููุชุทููุฑ ุงููุณุชูุจูู:
๐ **ุชุทุจูู ุงูุชุญุฏูุซุงุช ุงูููุชุฑุญุฉ** ููุฒูุฏ ูู ุงูุงุญุชุฑุงููุฉ
- ูุตู ุงูุงุชุตุงูุงุช ุงูููุฒููุฉ ูุงูุชุฌุงุฑูุฉ
- ุญุณุงุจ ุชููุงุฆู ููููุงุชูุฑ
- ุฏุนู ุฑูุน ุงููุณุชูุฏุงุช
- ุชุญุณููุงุช ุงูุฃุฏุงุก

---

## ๐ ุงูุฏุนู

ููุงุณุชูุณุงุฑุงุช ุฃู ุงููุณุงุนุฏุฉ:
- ุฑุงุฌุน `DOCUMENTATION.md` ููุชูุซูู ุงูููู
- ุฑุงุฌุน `README.md` ูุฏููู ุงูุงุณุชุฎุฏุงู
- ุฑุงุฌุน `todo.md` ููุงุฆูุฉ ุงูููุงู ุงููุชุจููุฉ

---

**ุชู ุฅูุดุงุก ูุฐุง ุงูููุฎุต ูู:** 2024-10-29  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุงุณุชุฎุฏุงู โ
